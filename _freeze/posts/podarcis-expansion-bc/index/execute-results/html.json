{
  "hash": "f9addf1273578762975add3e4b1120db",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Expansion of *Podarcis muralis* in British Columbia\"\ndescription: \"An exploration of the expansion of the common wall lizard in British Columbia using iNaturalist data.\"\ndate: 2026-01-16\ncategories: [lizards, iNaturalist, mapping]\nformat:\n  html:\n    code-fold: true\n    out-width: \"75%\"\n    fig-align: \"center\"\n    fig-dpi: 300\n    lightbox: true\neditor: \n  markdown:\n    wrap: 101\n---\n\n::: {.cell code-description='Setup'}\n\n:::\n\n\n\n## Context\n\nThe Common Wall Lizard (*Podarcis muralis*), a small lizard native to Europe, has become a\nconspicuous new resident in many parts of British Columbia. Since its introduction to Vancouver\nIsland in the 1970s from a small founding population, the lizard rapidly expanded. Its range has\ngrown exponentially, now covering a large portion of the island and with satellite populations\nappearing on the mainland and surrounding islands.\n\nThis exploration stems from my interest in putting together a CIRTA grant proposal together with some\nfolks at UBC to study the dynamics of this invasion. The abstract of the proposal was as follows:\n\n> Canada’s harsh winters have historically acted as a natural barrier to many invasive animal species\n> that flourish elsewhere. However, climate change is shifting these thermal boundaries, putting\n> ecosystems that were once safe at risk. Predicting poleward range expansion is challenging because\n> standard correlative methods often omit factors such as physiology, behavior, and the ability for\n> local adaptation, which can help invasive animals succeed in seemingly unsuitable climates.\n> Therefore, there is an urgent need for mechanistic frameworks that go beyond correlation to improve\n> predictions of invasive spread. I propose to develop such a framework using the invasion of the\n> common wall lizard (Podarcis muralis) on Vancouver Island as a model system. Despite apparent\n> mismatches in climate for this Mediterranean ectotherm, P. muralis has rapidly expanded across\n> British Columbia since its introduction in 1970. Now present on the Canadian mainland, it poses a\n> serious ecological threat by outcompeting native reptiles and disrupting local food webs through\n> insect predation. Based at the University of British Columbia, I will first assess the current\n> range and traits of the invading lizards. In partnership with Dr. Katie Marshall and Dr. Chris\n> Harley, I will then use ecophysiological modeling to understand how local climates and habitats\n> influence P. muralis’s physiology and behavior. These insights will be incorporated into a\n> hierarchical Bayesian framework, developed with Dr. Marie Auger-Methé, to discern the mechanisms\n> underlying the spread of P. muralis while rigorously accounting for observational biases and\n> spatiotemporal autocorrelations. Beyond generating habitat suitability maps to forecast the wall\n> lizard’s future spread, this research will establish a transferable, scalable framework for\n> modeling the colonization of high-latitude regions by non-native ectotherms. Ultimately, the\n> proposed framework will provide a mechanistic basis for assessing invasion risks across Canada’s\n> shifting latitudinal gradients, including the increasingly vulnerable Arctic and sub-Arctic\n> regions.\n\nI ended up getting the proposal funded but I declined it. \n\n## Data exploration\n\nBelow, I explore some data I obtained from iNaturalist to visualize the expansion of *Podarcis\nmuralis* in BC. The data includes observations of the species, with associated metadata such as\nlocation and date of observation.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Read and clean data\"}\n# read data\npodarcis <- read.csv(\"podarcis-obs-bc.csv\")\n\n# remove observations with missing coordinates\npodarcis <- podarcis |>\n  filter(!is.na(longitude) & !is.na(latitude)) |>\n  mutate(year = year(ymd_hms(time_observed_at))) |>\n  mutate(month = month(ymd_hms(time_observed_at))) |>\n  filter(!is.na(year)) |>\n  filter(longitude < -122)\n\n# sort by year\npodarcis <- podarcis[order(-podarcis$year), ]\n```\n:::\n\n\n\nNext, I use the function `ne_countries()` from the `rnaturalearth` package to get the country borders\nfor Canada and the USA, which I will use as a base layer for plotting the observations.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Get country borders for plotting\"}\n# get canada border\ncanada_border <- ne_countries(\n  country = \"canada\",\n  scale = \"large\",\n  returnclass = \"sf\"\n)\n\n# get usa border\nusa_border <- ne_countries(\n  country = \"united states of america\",\n  scale = \"large\",\n  returnclass = \"sf\"\n)\n```\n:::\n\n\n\nWith all that, I plot the observations of *Podarcis muralis* over space, using the country borders as\na base layer.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Plot observations over space\"}\nggplot() +\n  geom_sf(data = canada_border, fill = \"lightgray\", color = \"black\") +\n  geom_sf(data = usa_border, fill = \"lightgray\", color = \"black\") +\n  geom_point(data = podarcis, aes(x = longitude, y = latitude, color = year)) +\n  scale_color_viridis(option = \"viridis\", discrete = FALSE) +\n  theme_minimal() +\n  theme(\n    panel.background = element_rect(fill = \"lightblue\"),\n    panel.border = element_rect(fill = NA),\n    panel.grid = element_blank()\n  ) +\n  coord_sf(xlim = c(-125, -122), ylim = c(48, 50)) +\n  labs(x = \"\", y = \"\", color = \"Year\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=1500}\n:::\n:::\n\n\n\nAnd I plot the number of observations per year to visualize the temporal expansion of the species.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-summary=\"Plot observations over time\"}\npodarcis |>\n  group_by(year) |>\n  summarise(count = n()) |>\n  ggplot(aes(x = year, y = count)) +\n  geom_line() +\n  geom_point() +\n  theme_minimal() +\n  labs(x = \"Year\", y = \"Number of Observations\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){fig-align='center' width=75%}\n:::\n:::\n\n\n\nLastly, I plot the observations by month, standardized by year to visualize the seasonal pattern of\nobservations.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-summary=\"Plot observations by month\"}\npodarcis |>\n  group_by(year, month) |>\n  summarise(count = n()) |>\n  group_by(year) |>\n  mutate(relative_count = count / sum(count)) |>\n  ggplot(aes(x = month, y = year, fill = relative_count)) +\n  geom_tile() +\n  geom_text(aes(label = count), size = 3, color = \"white\") +\n  scale_fill_viridis() +\n  theme_minimal() +\n  scale_x_continuous(breaks = 1:12, labels = month.abb, expand = c(0, 0)) +\n  scale_y_continuous(expand = c(0, 0), breaks = seq(2005, 2025, 1)) +\n  labs(x = \"Month\", y = \"Year\", fill = \"Proportion\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){fig-align='center' width=75%}\n:::\n:::",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}